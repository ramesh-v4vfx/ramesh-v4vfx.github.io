<!DOCTYPE html>
<html lang="en">
<head>

  <!-- Google tag (gtag.js) -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-DZMEQ7NQCD"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-DZMEQ7NQCD');
</script>


<meta charset="UTF-8">
<title>Daily Diary</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<style>
body {
  font-family: system-ui, sans-serif;
  max-width: 720px;
  margin: auto;
  padding: 1rem;
}

*,
*::before,
*::after {
  box-sizing: border-box;
}


h1 {
  text-align: center;
}

.top-bar {
  display: flex;
  gap: 10px;
  flex-wrap: wrap;
  margin-bottom: 10px;
}

select, input[type="date"] {
  padding: 8px;
  font-size: 16px;
}


textarea {
  width: 100%;
  min-height: 40vh;
  padding: 14px;
  font-size: 16px;
  line-height: 1.6;
  resize: vertical;
}


.footer {
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-top: 8px;
  font-size: 14px;
  opacity: 0.8;
}

button {
  padding: 8px 12px;
  cursor: pointer;
}

body.dark {
  background: #121212;
  color: #eaeaea;
}

body.dark #diaryText {
  background: #1e1e1e;
  color: #eaeaea;
  border-color: #333;
}

body.dark button,
body.dark select,
body.dark input[type="date"] {
  background: #1e1e1e;
  color: #eaeaea;
  border: 1px solid #333;
}

body.dark button:hover {
  opacity: 0.85;
}

@media (max-width: 600px) {

 body {
  padding-left: 12px;
  padding-right: 12px;
  padding-top: 0.75rem;
  padding-bottom: 0.75rem;
  margin: 0;
}

textarea {
    width: 100%;
    margin-left: 0;
    margin-right: 0;
    display: block;
  }


  .top-bar {
    gap: 8px;
  }

  button {
    padding: 10px 14px;
    font-size: 16px;
  }

  #themeToggle {
    position: fixed;
    top: 10px;
    right: 10px;
    z-index: 10;
  }

  .footer {
    font-size: 13px;
  }
}


</style>
</head>



<body>

 <button id="themeToggle" title="Toggle dark mode">ğŸŒ™</button>

<h1>ğŸ“” Daily Diary</h1>

<div class="top-bar">
  <input type="date" id="datePicker">

  <select id="mood">
    <option value="ğŸ˜Š">ğŸ˜Š Happy</option>
    <option value="ğŸ˜">ğŸ˜ Neutral</option>
    <option value="ğŸ˜">ğŸ˜ Sad</option>
  </select>

  <button id="downloadBtn">Download</button>
</div>

<textarea
  id="diaryText"
  placeholder="Write your thoughts here..."
  spellcheck="false"
  autocomplete="off"
  autocorrect="off"
  autocapitalize="sentences">
</textarea>



<div class="footer">
  <span id="wordCount">0 words</span>
  <span id="status">Auto-saved</span>
</div>




<script>
const datePicker = document.getElementById("datePicker");
const diaryText = document.getElementById("diaryText");
const moodSelect = document.getElementById("mood");
const wordCount = document.getElementById("wordCount");
const status = document.getElementById("status");
const downloadBtn = document.getElementById("downloadBtn");

// Set today (viewer's local date)
const today = new Date().toLocaleDateString("en-CA");
datePicker.value = today;

// Load entry
loadEntry(today);


// Load entry
function loadEntry(date) {
  const data = JSON.parse(localStorage.getItem("diary-" + date)) || {
    text: "",
    mood: "ğŸ˜Š"
  };

  diaryText.value = data.text;
  moodSelect.value = data.mood;
  updateWordCount();
}

loadEntry(today);

// Auto-save
let saveTimer;
function autoSave() {
  clearTimeout(saveTimer);
  saveTimer = setTimeout(() => {
    const entry = {
      text: diaryText.value,
      mood: moodSelect.value
    };
    localStorage.setItem(
      "diary-" + datePicker.value,
      JSON.stringify(entry)
    );
    status.textContent = "Auto-saved âœ”";
  }, 400);
}

// Word count
function updateWordCount() {
  const words = diaryText.value.trim().split(/\s+/).filter(Boolean);
  wordCount.textContent = `${words.length} words`;
}

// Events
diaryText.addEventListener("input", () => {
  updateWordCount();
  autoSave();
});

moodSelect.addEventListener("change", autoSave);

datePicker.addEventListener("change", () => {
  loadEntry(datePicker.value);
  status.textContent = "Loaded";
});

// Download
downloadBtn.addEventListener("click", () => {
  const date = datePicker.value;
  const data = JSON.parse(localStorage.getItem("diary-" + date)) || {};
  const text =
`Date: ${date}
Mood: ${data.mood || ""}

${data.text || ""}`;

  const blob = new Blob([text], { type: "text/plain" });
  const link = document.createElement("a");
  link.href = URL.createObjectURL(blob);
  link.download = `diary-${date}.txt`;
  link.click();
  URL.revokeObjectURL(link.href);
});

const themeToggle = document.getElementById("themeToggle");

// Load saved theme
if (localStorage.getItem("theme") === "dark") {
  document.body.classList.add("dark");
  themeToggle.textContent = "â˜€ï¸";
}

// Toggle theme
themeToggle.addEventListener("click", () => {
  document.body.classList.toggle("dark");

  const isDark = document.body.classList.contains("dark");
  localStorage.setItem("theme", isDark ? "dark" : "light");
  themeToggle.textContent = isDark ? "â˜€ï¸" : "ğŸŒ™";
});

</script>

</body>
</html>
